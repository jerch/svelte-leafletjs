{"version":3,"file":"bundle-sandbox-sXgGuiG3.js","sources":["../../../node_modules/.pnpm/@histoire+app@0.17.8_vite@5.0.12/node_modules/@histoire/app/dist/bundled/sandbox.js"],"sourcesContent":["import { parseQuery } from \"@histoire/vendors/vue-router\";\nimport { ref, computed, watch, onMounted, h, createApp } from \"@histoire/vendors/vue\";\nimport { createPinia } from \"@histoire/vendors/pinia\";\nimport { applyState } from \"@histoire/shared\";\nimport \"./components/story/GenericMountStory.vue.js\";\nimport \"./components/story/GenericRenderStory.vue.js\";\nimport { mapFile } from \"./util/mapping.js\";\nimport { files } from \"virtual:$histoire-stories\";\nimport { STATE_SYNC, PREVIEW_SETTINGS_SYNC, SANDBOX_READY } from \"./util/const.js\";\nimport { applyPreviewSettings } from \"./util/preview-settings.js\";\nimport { isDark } from \"./util/dark.js\";\nimport { histoireConfig } from \"./util/config.js\";\nimport { toRawDeep } from \"./util/state.js\";\nimport { setupPluginApi } from \"./plugin.js\";\nimport _sfc_main from \"./components/story/GenericMountStory.vue2.js\";\nimport _sfc_main$1 from \"./components/story/GenericRenderStory.vue2.js\";\n\"use strict\";\nconst query = parseQuery(window.location.search);\nconst file = ref(mapFile(files.find((f) => f.id === query.storyId)));\nconst app = createApp({\n  name: \"SandboxApp\",\n  setup() {\n    const story = computed(() => file.value.story);\n    const variant = computed(() => {\n      var _a;\n      return (_a = story.value) == null ? void 0 : _a.variants.find((v) => v.id === query.variantId);\n    });\n    let synced = false;\n    let mounted = false;\n    window.addEventListener(\"message\", (event) => {\n      var _a, _b;\n      if (((_a = event.data) == null ? void 0 : _a.type) === STATE_SYNC) {\n        if (!mounted)\n          return;\n        synced = true;\n        applyState(variant.value.state, event.data.state);\n      } else if (((_b = event.data) == null ? void 0 : _b.type) === PREVIEW_SETTINGS_SYNC) {\n        applyPreviewSettings(event.data.settings);\n      }\n    });\n    watch(() => variant.value.state, (value) => {\n      var _a;\n      if (synced && mounted) {\n        synced = false;\n        return;\n      }\n      (_a = window.parent) == null ? void 0 : _a.postMessage({\n        type: STATE_SYNC,\n        state: toRawDeep(value, true)\n      });\n    }, {\n      deep: true\n    });\n    onMounted(() => {\n      mounted = true;\n    });\n    return {\n      story,\n      variant\n    };\n  },\n  render() {\n    return [\n      h(\"div\", { class: \"htw-sandbox-hidden\" }, [\n        h(_sfc_main, {\n          key: file.value.story.id,\n          story: file.value.story\n        })\n      ]),\n      this.story && this.variant ? h(_sfc_main$1, {\n        story: this.story,\n        variant: this.variant,\n        onReady: () => {\n          var _a;\n          (_a = window.parent) == null ? void 0 : _a.postMessage({\n            type: SANDBOX_READY\n          });\n        }\n      }) : null\n    ];\n  }\n});\napp.use(createPinia());\napp.mount(\"#app\");\nwatch(isDark, (value) => {\n  if (value) {\n    document.documentElement.classList.add(histoireConfig.sandboxDarkClass);\n    document.documentElement.classList.add(histoireConfig.theme.darkClass);\n  } else {\n    document.documentElement.classList.remove(histoireConfig.sandboxDarkClass);\n    document.documentElement.classList.remove(histoireConfig.theme.darkClass);\n  }\n}, {\n  immediate: true\n});\nif (import.meta.hot) {\n  /* @__PURE__ */ setupPluginApi();\n}\n"],"names":[],"mappings":";;;AAiBA,MAAM,QAAQ,WAAW,OAAO,SAAS,MAAM;AAC/C,MAAM,OAAO,IAAI,QAAQ,MAAM,KAAK,CAAC,MAAM,EAAE,OAAO,MAAM,OAAO,CAAC,CAAC;AACnE,MAAM,MAAM,UAAU;AAAA,EACpB,MAAM;AAAA,EACN,QAAQ;AACN,UAAM,QAAQ,SAAS,MAAM,KAAK,MAAM,KAAK;AACvC,UAAA,UAAU,SAAS,MAAM;AACzB,UAAA;AACJ,cAAQ,KAAK,MAAM,UAAU,OAAO,SAAS,GAAG,SAAS,KAAK,CAAC,MAAM,EAAE,OAAO,MAAM,SAAS;AAAA,IAAA,CAC9F;AACD,QAAI,SAAS;AACb,QAAI,UAAU;AACP,WAAA,iBAAiB,WAAW,CAAC,UAAU;AAC5C,UAAI,IAAI;AACR,YAAM,KAAK,MAAM,SAAS,OAAO,SAAS,GAAG,UAAU,YAAY;AACjE,YAAI,CAAC;AACH;AACO,iBAAA;AACT,mBAAW,QAAQ,MAAM,OAAO,MAAM,KAAK,KAAK;AAAA,MAClD,aAAa,KAAK,MAAM,SAAS,OAAO,SAAS,GAAG,UAAU,uBAAuB;AAC9D,6BAAA,MAAM,KAAK,QAAQ;AAAA,MAC1C;AAAA,IAAA,CACD;AACD,UAAM,MAAM,QAAQ,MAAM,OAAO,CAAC,UAAU;AACtC,UAAA;AACJ,UAAI,UAAU,SAAS;AACZ,iBAAA;AACT;AAAA,MACF;AACA,OAAC,KAAK,OAAO,WAAW,OAAO,SAAS,GAAG,YAAY;AAAA,QACrD,MAAM;AAAA,QACN,OAAO,UAAU,OAAO,IAAI;AAAA,MAAA,CAC7B;AAAA,IAAA,GACA;AAAA,MACD,MAAM;AAAA,IAAA,CACP;AACD,cAAU,MAAM;AACJ,gBAAA;AAAA,IAAA,CACX;AACM,WAAA;AAAA,MACL;AAAA,MACA;AAAA,IAAA;AAAA,EAEJ;AAAA,EACA,SAAS;AACA,WAAA;AAAA,MACL,EAAE,OAAO,EAAE,OAAO,wBAAwB;AAAA,QACxC,EAAE,WAAW;AAAA,UACX,KAAK,KAAK,MAAM,MAAM;AAAA,UACtB,OAAO,KAAK,MAAM;AAAA,QAAA,CACnB;AAAA,MAAA,CACF;AAAA,MACD,KAAK,SAAS,KAAK,UAAU,EAAE,aAAa;AAAA,QAC1C,OAAO,KAAK;AAAA,QACZ,SAAS,KAAK;AAAA,QACd,SAAS,MAAM;AACT,cAAA;AACJ,WAAC,KAAK,OAAO,WAAW,OAAO,SAAS,GAAG,YAAY;AAAA,YACrD,MAAM;AAAA,UAAA,CACP;AAAA,QACH;AAAA,MACD,CAAA,IAAI;AAAA,IAAA;AAAA,EAET;AACF,CAAC;AACD,IAAI,IAAI,aAAa;AACrB,IAAI,MAAM,MAAM;AAChB,MAAM,QAAQ,CAAC,UAAU;AACvB,MAAI,OAAO;AACT,aAAS,gBAAgB,UAAU,IAAI,eAAe,gBAAgB;AACtE,aAAS,gBAAgB,UAAU,IAAI,eAAe,MAAM,SAAS;AAAA,EAAA,OAChE;AACL,aAAS,gBAAgB,UAAU,OAAO,eAAe,gBAAgB;AACzE,aAAS,gBAAgB,UAAU,OAAO,eAAe,MAAM,SAAS;AAAA,EAC1E;AACF,GAAG;AAAA,EACD,WAAW;AACb,CAAC;","x_google_ignoreList":[0]}